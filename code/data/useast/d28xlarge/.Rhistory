r <- barplot(tN, col = rainbow(20))
#- type = "h" plotting *is* 'bar'plot
lines(r, tN, type = "h", col = "red", lwd = 2)
barplot(tN, space = 1.5, axisnames = FALSE,
sub = "barplot(..., space= 1.5, axisnames = FALSE)")
barplot(VADeaths, plot = FALSE)
barplot(VADeaths, plot = FALSE, beside = TRUE)
lt
tot <- colMeans(VADeaths)
text(mp, tot + 3, format(tot), xpd = TRUE, col = "blue")
barplot(VADeaths, beside = TRUE,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = rownames(VADeaths), ylim = c(0, 100))
title(main = "Death Rates in Virginia", font.main = 4)
mp <- barplot(VADeaths) # default
tot <- colMeans(VADeaths)
text(mp, tot + 3, format(tot), xpd = TRUE, col = "blue")
barplot(VADeaths, beside = TRUE,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = rownames(VADeaths), ylim = c(0, 100))
title(main = "Death Rates in Virginia", font.main = 4)
barplot(VADeaths, beside = TRUE,
mp <- barplot(VADeaths) # default
tot <- colMeans(VADeaths)
mp <- barplot(VADeaths) # default
tot <- colMeans(VADeaths)
text(mp, tot + 3, format(tot), xpd = TRUE, col = "blue")
barplot(VADeaths, beside = TRUE,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = rownames(VADeaths), ylim = c(0, 100))
barplot(x, beside = TRUE,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = rownames(VADeaths), ylim = c(0, 100))
barplot(x, beside = F,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = rownames(VADeaths), ylim = c(0, 100))
barplot(x, beside = F,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = rownames(VADeaths), ylim = c(0, 100))
barplot(x, beside = T,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = rownames(VADeaths), ylim = c(0, 100))
legend = rownames(VADeaths))
barplot(x, beside = T,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = rownames(VADeaths))
barplot(x, beside = T,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = c(1,2,3,4,5,6))
mp <- barplot(VADeaths) # default
tot <- colMeans(VADeaths)
text(mp, tot + 3, format(tot), xpd = TRUE, col = "blue")
barplot(VADeaths, beside = TRUE,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = rownames(VADeaths), ylim = c(0, 100))
title(main = "Death Rates in Virginia", font.main = 4)
mp <- barplot(VADeaths) # default
tot <- colMeans(VADeaths)
text(mp, tot + 3, format(tot), xpd = TRUE, col = "blue")
barplot(VADeaths, beside = TRUE,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = rownames(VADeaths), ylim = c(0, 100))
mp
tot
mp <- barplot(VADeaths) # default
tot <- colMeans(VADeaths)
barplot(VADeaths, beside = TRUE,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = rownames(VADeaths), ylim = c(0, 100))
VADeaths
matrix(c(1,2,3,4,5,6),nrow = 3,ncol = 2)
x<-matrix(c(10154,6504,3465,5520,3988,1530))
barplot(x, beside = T,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = c(1,2,3))
barplot(x, beside = T,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = c(1,2,3),space = 0.2)
barplot(VADeaths, beside = TRUE,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = rownames(VADeaths), ylim = c(0, 100))
barplot(x, beside = T,
col = c("lightblue", "mistyrose"),
legend = c(1,2,3))
barplot(x, beside = T,
col = c("lightblue", "mistyrose"),
legend = c("male","female"))
mp <- barplot(VADeaths) # default
tot <- colMeans(VADeaths)
text(mp, tot + 3, format(tot), xpd = TRUE, col = "blue")
barplot(VADeaths, beside = TRUE,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = rownames(VADeaths), ylim = c(0, 100))
barplot(VADeaths, beside = TRUE,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
ylim = c(0, 100))
rownames(x)<-c("本科","硕士","博士")
x
x<-matrix(c(10154,6504,3465,5520,3988,1530))
x
x<-matrix(c(10154,6504,3465,5520,3988,1530),nrow = 3,ncol = 2)
x
barplot(x, beside = T,
col = c("lightblue", "mistyrose"),
legend = c("male","female"))
x<-c(10154,5220,6504,3988,3465,1530)
x<-matrix(x,nrow = 2,ncol = 3)
x
colnames(x)<-c("本科","硕士","博士")
barplot(x, beside = T,
col = c("lightblue", "mistyrose"),
legend = c("male","female"))
x<-c(10154,5220,6504,3988,3465,1530)
x<-matrix(x,nrow = 2,ncol = 3)
colnames(x)<-c("1","2","3")
barplot(x, beside = T,
col = c("lightblue", "mistyrose"),
legend = c("male","female"))
x<-c(10154,5220,6504,3988,3465,1530)
x<-matrix(x,nrow = 2,ncol = 3)
colnames(x)<-c("undergraduate","master","doctor")
barplot(x, beside = T,
col = c("lightblue", "mistyrose"),
legend = c("male","female"))
barplot(x, beside = T,
col = rainbow(2),
legend = c("male","female"))
mp <- barplot(VADeaths) # default
tot <- colMeans(VADeaths)
text(mp, tot + 3, format(tot), xpd = TRUE, col = "blue")
barplot(VADeaths, beside = TRUE,
col = c("lightblue", "mistyrose", "lightcyan",
"lavender", "cornsilk"),
legend = rownames(VADeaths), ylim = c(0, 100))
title(main = "Death Rates in Virginia", font.main = 4)
text(mp, tot + 3, format(tot), xpd = TRUE, col = "blue")
hh <- t(VADeaths)[, 5:1]
mybarcol <- "gray20"
mp <- barplot(hh, beside = TRUE,
col = c("lightblue", "mistyrose",
"lightcyan", "lavender"),
legend = colnames(VADeaths), ylim = c(0,100),
main = "Death Rates in Virginia", font.main = 4,
sub = "Faked upper 2*sigma error bars", col.sub = mybarcol,
cex.names = 1.5)
segments(mp, hh, mp, hh + 2*sqrt(1000*hh/100), col = mybarcol, lwd = 1.5)
stopifnot(dim(mp) == dim(hh))  # corresponding matrices
mtext(side = 1, at = colMeans(mp), line = -2,
text = paste("Mean", formatC(colMeans(hh))), col = "red")
x<-c(10154,5220,6504,3988,3465,1530)
x<-matrix(x,nrow = 2,ncol = 3)
colnames(x)<-c("undergraduate","master","doctor")
barplot(x, beside = T,
col = rainbow(2),
legend = c("male","female"))
title(main = "性别学历分布图", font.main = 4)
title(main = "sex and education distribution map", font.main = 4)
x<-c(10154,5220,6504,3988,3465,1530)
x<-matrix(x,nrow = 2,ncol = 3)
colnames(x)<-c("undergraduate","master","doctor")
barplot(x, beside = T,
col = rainbow(2),
legend = c("male","female"))
title(main = "sex and education distribution map", font.main = 4)
barplot(x, beside = T,
col = rainbow(2),
legend = c("male","female")，space = 0.3)
barplot(x, beside = T,
col = rainbow(2),
legend = c("male","female")，space = 0.3)
barplot(x, beside = T,
col = rainbow(2),
legend = c("male","female"),space = 0.3)
legend = c("male","female"),space = 1)
barplot(x, beside = T,
col = rainbow(2),
legend = c("male","female"),space = 1)
barplot(x, beside = T,
col = rainbow(2),
legend = c("male","female"))
x
sum(x(1,))
sum(x[1,])
sum(x[1,])/sum(x[2,])
x<-c(10154,5220,6504,3988,3465,1530)
x<-matrix(x,nrow = 2,ncol = 3)
colnames(x)<-c("undergraduate","master","doctor")
barplot(x, beside = T,
col = rainbow(2),
legend = c("male","female"))
title(main = "sex and education distribution map", font.main = 4)
b<-c(sum(x[,1]),sum(x[,2]),sum(x[,3]))
b
b/b[3]
library(rattle)
data<-audit
library(klaR)
computer.NB<-NaiveBayes(data[,2:10],grouping = factor(data[,13]),usekernel = T,fL=1)
computer.NB.predict<-predict(computer.NB,data[,2:10])
library(kknn)
computer.kknn<-kknn(factor(TARGET_Adjusted)~Age+Income+Deductions+Hours,train = data[,c(2,7,9,10,13)],test = data[,c(2,7,9,10)],k = 38,scale = T,kernel = "rectangular")
#错判率
table(data[,13],computer.NB.predict$class)
error.NB<-sum(as.numeric(computer.NB.predict$class!=data[,13]))/nrow(data)
error.NB
error.kknn<-sum(computer.kknn$fitted.values!=data[,13])/nrow(data)
error.kknn
#kappa系数
library(fmsb)
kappa.NB<-Kappa.test(table(data[,13],computer.NB.predict$class))
kappa.NB
kappa.kknn<-Kappa.test(table(data[,13],computer.kknn$fitted.values))
kappa.kknn
computer.NB.predict$labels <- data[,13]
computer.NB.predict$predictions <-computer.NB.predict$posterior[,2]
pred <- prediction(computer.NB.predict$predictions, computer.NB.predict$labels)
#敏感度-特异度曲线
perf1 <- performance(pred,"sens","spec")
plot(perf1)
library(ROCR)
pred <- prediction(computer.NB.predict$predictions, computer.NB.predict$labels)
#敏感度-特异度曲线
perf1 <- performance(pred,"sens","spec")
plot(perf1)
computer.kknn$labels <- data[,13]
computer.kknn$predictions <-computer.kknn$posterior[,2]
pred.kknn <- prediction(computer.kknn$predictions, computer.kknn$labels)
computer.kknn$labels <- data[,13]
computer.kknn$predictions <-computer.kknn$posterior[,2]
pred.kknn <- prediction(computer.kknn$predictions, computer.kknn$labels)
help("prediction")
computer.kknn$predictions
computer.kknn$posterior[,2]
computer.NB.predict$posterior[,2]
perf2 <- performance(pred.NB,"tpr","fpr")
perf1.NB <- performance(pred.NB,"sens","spec")
library(ROCR)
computer.NB.predict$labels <- data[,13]
computer.NB.predict$predictions <-computer.NB.predict$posterior[,2]
pred.NB <- prediction(computer.NB.predict$predictions, computer.NB.predict$labels)
#敏感度-特异度曲线
perf1.NB <- performance(pred.NB,"sens","spec")
plot(perf1.NB)
#ROC
perf2 <- performance(pred.NB,"tpr","fpr")
plot(perf2)
#召回率-精确率曲线
perf3 <- performance(pred.NB,"prec","rec")
plot(perf3)
#提升图
perf4 <- performance(pred.NB,"lift","rpp")
plot(perf4)
perf4
computer.kknn
computer.kknn$prob
library(ROCR)
computer.NB.predict$labels <- data[,13]
computer.kknn$labels<-data[,13]
computer.NB.predict$predictions <-computer.NB.predict$posterior[,2]
computer.kknn$predictions<-computer.kknn$prob[,2]
pred.NB <- prediction(computer.NB.predict$predictions, computer.NB.predict$labels)
pred.kknn<- prediction(computer.kknn$predictions,computer.kknn$labels)
#敏感度-特异度曲线
perf1.NB <- performance(pred.NB,"sens","spec")
perf1.kknn<- performance(pred.kknn,"sens","spec")
perf1.NB <- performance(pred.NB,"sens","spec")
perf1.kknn<- performance(pred.kknn,"sens","spec")
plot(perf1.NB,col="red")
plot(perf1.kknn,col="blue",add=T)
#ROC
perf2.NB <- performance(pred.NB,"tpr","fpr")
perf2.kknn<-performance(pred.kknn,"tpr","fpr")
plot(perf2.NB,col="red")
plot(perf2.kknn,col="blue",add=T)
perf3.NB <- performance(pred.NB,"prec","rec")
perf3.kknn<-performance(pred.kknn,"prec","rec")
plot(perf3.NB)
plot(perf3.kknn)
plot(perf3.NB,col="red")
plot(perf3.NB,col="red")
plot(perf3.NB,col="red")
plot(perf3.kknn,col="blue",add=T)
perf4.NB <- performance(pred.NB,"lift","rpp")
perf4.kknn<-performance(pred.kknn,"lift","rpp")
plot(perf4.NB,col="red")
plot(perf4.kknn,col="blue",add=T)
library(rattle)
data<-audit
library(klaR)
computer.NB<-NaiveBayes(data[,2:10],grouping = factor(data[,13]),usekernel = T,fL=1)
computer.NB.predict<-predict(computer.NB,data[,2:10])
library(kknn)
computer.kknn<-kknn(factor(TARGET_Adjusted)~Age+Income+Deductions+Hours,train = data[,c(2,7,9,10,13)],test = data[,c(2,7,9,10)],k = 38,scale = T,kernel = "rectangular")
#错判率
table(data[,13],computer.NB.predict$class)
error.NB<-sum(as.numeric(computer.NB.predict$class!=data[,13]))/nrow(data)
error.NB
error.kknn<-sum(computer.kknn$fitted.values!=data[,13])/nrow(data)
error.kknn
#kappa系数
library(fmsb)
kappa.NB<-Kappa.test(table(data[,13],computer.NB.predict$class))
kappa.NB
kappa.kknn<-Kappa.test(table(data[,13],computer.kknn$fitted.values))
kappa.kknn
computer.NB.predict$labels <- data[,13]
computer.kknn$labels<-data[,13]
computer.NB.predict$predictions <-computer.NB.predict$posterior[,2]
computer.kknn$predictions<-computer.kknn$prob[,2]
pred.NB <- prediction(computer.NB.predict$predictions, computer.NB.predict$labels)
pred.kknn<- predic
library(ROCR)
computer.NB.predict$labels <- data[,13]
computer.kknn$labels<-data[,13]
computer.NB.predict$predictions <-computer.NB.predict$posterior[,2]
computer.kknn$predictions<-computer.kknn$prob[,2]
pred.NB <- prediction(computer.NB.predict$predictions, computer.NB.predict$labels)
pred.kknn<- prediction(computer.kknn$predictions,computer.kknn$labels)
#敏感度-特异度曲线
perf1.NB <- performance(pred.NB,"sens","spec")
perf1.kknn<- performance(pred.kknn,"sens","spec")
plot(perf1.NB,col="red")
plot(perf1.kknn,col="blue",add=T)
#ROC
perf2.NB <- performance(pred.NB,"tpr","fpr")
perf2.kknn<-performance(pred.kknn,"tpr","fpr")
plot(perf2.NB,col="red")
plot(perf2.kknn,col="blue",add=T)
#召回率-精确率曲线
perf3.NB <- performance(pred.NB,"prec","rec")
perf3.kknn<-performance(pred.kknn,"prec","rec")
plot(perf3.NB,col="red")
plot(perf3.kknn,col="blue",add=T)
#提升图
perf4.NB <- performance(pred.NB,"lift","rpp")
perf4.kknn<-performance(pred.kknn,"lift","rpp")
plot(perf4.NB,col="red")
plot(perf4.kknn,col="blue",add=T)
library(rattle)
data<-audit
library(klaR)
computer.NB<-NaiveBayes(data[,2:10],grouping = factor(data[,13]),usekernel = T,fL=1)
computer.NB.predict<-predict(computer.NB,data[,2:10])
library(kknn)
computer.kknn<-kknn(factor(TARGET_Adjusted)~Age+Income+Deductions+Hours,train = data[,c(2,7,9,10,13)],test = data[,c(2,7,9,10)],k = 38,scale = T,kernel = "rectangular")
#错判率
table(data[,13],computer.NB.predict$class)
error.NB<-sum(as.numeric(computer.NB.predict$class!=data[,13]))/nrow(data)
error.NB
error.kknn<-sum(computer.kknn$fitted.values!=data[,13])/nrow(data)
error.kknn
#kappa系数
library(fmsb)
kappa.NB<-Kappa.test(table(data[,13],computer.NB.predict$class))
kappa.NB
kappa.kknn<-Kappa.test(table(data[,13],computer.kknn$fitted.values))
kappa.kknn
#考虑成本评估
library(ROCR)
computer.NB.predict$labels <- data[,13]
computer.kknn$labels<-data[,13]
computer.NB.predict$predictions <-computer.NB.predict$posterior[,1]
computer.kknn$predictions<-computer.kknn$prob[,1]
pred.NB <- prediction(computer.NB.predict$predictions, computer.NB.predict$labels)
pred.kknn<- prediction(computer.kknn$predictions,computer.kknn$labels)
#敏感度-特异度曲线
perf1.NB <- performance(pred.NB,"sens","spec")
perf1.kknn<- performance(pred.kknn,"sens","spec")
plot(perf1.NB,col="red")
plot(perf1.kknn,col="blue",add=T)
#ROC
perf2.NB <- performance(pred.NB,"tpr","fpr")
perf2.kknn<-performance(pred.kknn,"tpr","fpr")
plot(perf2.NB,col="red")
plot(perf2.kknn,col="blue",add=T)
#召回率-精确率曲线
perf3.NB <- performance(pred.NB,"prec","rec")
perf3.kknn<-performance(pred.kknn,"prec","rec")
plot(perf3.NB,col="red")
plot(perf3.kknn,col="blue",add=T)
#提升图
perf4.NB <- performance(pred.NB,"lift","rpp")
perf4.kknn<-performance(pred.kknn,"lift","rpp")
plot(perf4.NB,col="red")
plot(perf4.kknn,col="blue",add=T)
library(ROCR)
computer.NB.predict$labels <- data[,13]
computer.kknn$labels<-data[,13]
computer.NB.predict$predictions <-computer.NB.predict$posterior[,1]
computer.kknn$predictions<-computer.kknn$prob[,1]
pred.NB <- prediction(computer.NB.predict$predictions, computer.NB.predict$labels)
pred.kknn<- prediction(computer.kknn$predictions,computer.kknn$labels)
#敏感度-特异度曲线
perf1.NB <- performance(pred.NB,"sens","spec")
perf1.kknn<- performance(pred.kknn,"sens","spec")
plot(perf1.NB,col="red")
plot(perf1.kknn,col="blue",add=T)
#ROC
perf2.NB <- performance(pred.NB,"tpr","fpr")
perf2.kknn<-performance(pred.kknn,"tpr","fpr")
plot(perf2.NB,col="red")
plot(perf2.kknn,col="blue",add=T)
#召回率-精确率曲线
perf3.NB <- performance(pred.NB,"prec","rec")
perf3.kknn<-performance(pred.kknn,"prec","rec")
plot(perf3.NB,col="red")
plot(perf3.kknn,col="blue",add=T)
#提升图
perf4.NB <- performance(pred.NB,"lift","rpp")
perf4.kknn<-performance(pred.kknn,"lift","rpp")
plot(perf4.NB,col="red")
plot(perf4.kknn,col="blue",add=T)
0.5*(1-((4/7)^2+(3/7)^2)+1-((1/7)^2)+(6/7)^2)
0.5*(1-((4/7)^2+(3/7)^2)+1-((1/7)^2+(6/7)^2))
0.5*(1-((3/5)^2+(2/5)^2)+1-((2/9)^2+(7/9)^2))
0.5*(1-((3/9)^2+(6/9)^2)+1-((2/5)^2+(3/5)^2))
0.5*(1-((5/10)^2+(5/10)^2)+1-((0/4)^2+(4/4)^2))
10/14*(1-((5/10)^2+(5/10)^2))+4/14*(1-((0/4)^2+(4/4)^2))
library(rattle)
library(sampling)
library(class)
formula_audit<-TARGET_Adjusted~Age+Employment+Education+Marital+Occupation+Income+Gender+Deductions+Hours
set.seed(1)
n<-round(2/3*nrow(audit))
sub_train<-sample(1:nrow(audit),n)
data_train<-getdata(data,sub_train)
data_test<-getdata(data,-sub_train)
rp_audit<-rpart(formula_audit,data_train,maxdepth=10,minsplit=1,cp=0.01)
library(rpart)
library(rpart.plot)
library(maptree)
rp_audit<-rpart(formula_audit,data_train,maxdepth=10,minsplit=1,cp=0.01)
rpart.plot(rp_audit)
rpart.plot(rp_audit,type=4,fallen.leaves=TRUE)
predict(rp_audit,data_test,type="prob")
data_train<-getdata(data,sub_train)
data_test<-getdata(data,-sub_train)
rp_audit<-rpart(formula_audit,data_train,maxdepth=10,minsplit=1,cp=0.01)
rpart.plot(rp_audit,type=4,fallen.leaves=TRUE)
print(rp_audit)
head(audit)
formula_audit<-factor(TARGET_Adjusted)~Age+Employment+Education+Marital+Occupation+Income+Gender+Deductions+Hours
set.seed(1)
n<-round(2/3*nrow(audit))
sub_train<-sample(1:nrow(audit),n)
data_train<-getdata(data,sub_train)
data_test<-getdata(data,-sub_train)
rp_audit<-rpart(formula_audit,data_train,maxdepth=10,minsplit=1,cp=0.01)
print(rp_audit)
rpart.plot(rp_audit,type=4,fallen.leaves=TRUE)
predict(rp_audit,data_test,type="prob")
help("write.csv")
?predict
help(rpart)
install.packages(caretRnsemble)
install.packages('caretEnsemble')
install.packages("caret")
install.packages("caret")
(92*3+97*2+97*2+82*4+95*2+76*3+91*2+90*2)/(3+2+2+4+2+3+4)
install.packages(arules)
install.packages("arules")
library(arules)
data("Groceries")
Groceries
inspect(Groceries[1:10])
Summary(Groceries)
summary(Groceries)
itemsets_apr<-apriori(Groceries,parameter = list(supp=0.001,target="frequent items"),control = list(sort=-1))
names(itemsets_apr)
itemsets_apr
inspect(itemsets_apr[1:5])
itemsets_apr<-apriori(Groceries,parameter = list(supp=0.001,minlen=3,target="frequent items"),control = list(sort=-1))
inspect(itemsets_apr[1:5])
itemsets_apr<-apriori(Groceries,parameter = list(supp=0.001,minlen=3),control = list(sort=-1))
inspect(itemsets_apr[1:5])
fit <- auto.arima(WWWusage)
library(forecast)
library(forecast)
fit <- auto.arima(WWWusage)
fit
plot(forecast(fit,h=20))
w[1,2]
w[1,3]
setwd("/Users/wxc575843/Documents/papers/fxu/code/data/useast/d28xlarge/")
w=read.table("useast1a.txt",header = TRUE)
w[1,3]
files<-c("useast1a.txt","useast1b.txt","useast1c.txt","useast1d.txt","useast1e.txt")
files
files(1)
files[1]
getwd
getwd()
files<-c("useast1a.txt","useast1c.txt","useast1d.txt","useast1e.txt")
filename = files[k]
filename = files[1]
